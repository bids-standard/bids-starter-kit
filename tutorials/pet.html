
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PET data conversion &#8212; BIDS starter kit</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MRI data conversion" href="mri.html" />
    <link rel="prev" title="ASL data conversion" href="asl.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">BIDS starter kit</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to the BIDS Starter Kit
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Folders and files
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../folders_and_files/folders.html">
   Folders
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../folders_and_files/files.html">
   Filenames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../folders_and_files/metadata.html">
   Metadata and file formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/bids-standard/bids-starter-kit/tree/main/templates">
   BIDS files templates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../folders_and_files/derivatives.html">
   Derivatives
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="annotation.html">
   Annotating a BIDS dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ieeg.html">
   iEEG data conversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="asl.html">
   ASL data conversion
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   PET data conversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mri.html">
   MRI data conversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tutorials.html">
   Tutorials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dataset_examples.html">
   BIDS data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../talks.html">
   Talks and slides
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../publications.html">
   Publications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dependencies.html">
   BIDS Dependencies List
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../links.html">
   Links and resources
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Others
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../validator.html">
   BIDS validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq.html">
   Frequently Asked Questions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   BIDS jargon busting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contact.html">
   Contact
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/tutorials/pet.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/bids-standard/bids-starter-kit"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/bids-standard/bids-starter-kit/issues/new?title=Issue%20on%20page%20%2Ftutorials/pet.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/bids-standard/bids-starter-kit/edit/main/src/tutorials/pet.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#history">
   History
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pet-image-data-file-formats">
   PET image data file formats
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conversion">
   Conversion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conversion-of-pet-data-using-pet2bids">
     1) Conversion of PET data using PET2BIDS
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-dcm2niix">
       get dcm2niix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-python">
       For Python
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-matlab">
       For MATLAB
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manual-conversion-of-pet-data-to-pet-bids">
     2) Manual conversion of PET data to PET BIDS
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pet-image-data-in-ecat-format">
       PET image data in ECAT format
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#setting-the-layout">
       Setting the layout
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#collecting-and-installing-tpcclib">
       Collecting and installing TPCCLIB
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#last-pass">
       Last Pass
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validating-your-converted-pet-bids-data-set">
   Validating your converted PET BIDS data set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installing-the-validator">
     Installing the validator
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validating-your-new-dataset">
     Validating your new dataset
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tools-and-resources-for-pet-conversion">
   Tools and resources for PET conversion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#final-thoughts">
   Final thoughts
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>PET data conversion</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#history">
   History
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pet-image-data-file-formats">
   PET image data file formats
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conversion">
   Conversion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conversion-of-pet-data-using-pet2bids">
     1) Conversion of PET data using PET2BIDS
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-dcm2niix">
       get dcm2niix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-python">
       For Python
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-matlab">
       For MATLAB
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manual-conversion-of-pet-data-to-pet-bids">
     2) Manual conversion of PET data to PET BIDS
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pet-image-data-in-ecat-format">
       PET image data in ECAT format
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#setting-the-layout">
       Setting the layout
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#collecting-and-installing-tpcclib">
       Collecting and installing TPCCLIB
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#last-pass">
       Last Pass
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validating-your-converted-pet-bids-data-set">
   Validating your converted PET BIDS data set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installing-the-validator">
     Installing the validator
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validating-your-new-dataset">
     Validating your new dataset
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tools-and-resources-for-pet-conversion">
   Tools and resources for PET conversion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#final-thoughts">
   Final thoughts
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="pet-data-conversion">
<h1>PET data conversion<a class="headerlink" href="#pet-data-conversion" title="Permalink to this headline">¶</a></h1>
<div class="section" id="history">
<h2>History<a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h2>
<p>The PET modality is an addition to BIDS with its introduction via BEP 009.
If you’re interested in seeing exactly what and how something gets added to BIDS
see the pull request for BEP009
<a class="reference external" href="https://github.com/bids-standard/bids-specification/pull/633">here</a>.
The results of that extension proposal can be read
<a class="reference external" href="https://bids-specification.readthedocs.io/en/stable/04-modality-specific-files/09-positron-emission-tomography.html#positron-emission-tomography">here</a>
in the BIDS standard.</p>
</div>
<div class="section" id="pet-image-data-file-formats">
<h2>PET image data file formats<a class="headerlink" href="#pet-image-data-file-formats" title="Permalink to this headline">¶</a></h2>
<p>Before we start to convert data we need to quickly mention
that PET image data files come of the scanner in various different formats:
some scanners provide DICOM files (.dcm)
and others use proprietary formats for example ECAT format (.v).
In order to facilitate easy testing of data conversion across different PET file formats
the <a class="reference external" href="https://openneuropet.github.io/">OpenNeuroPET project</a> has compiled a bunch of phantom data
from different scanner types and is distributing two examples
<a class="reference external" href="https://drive.google.com/file/d/10S0H7HAnMmxHNpZLlifR14ykIuiXcBAD/view?usp=sharing">here</a>.</p>
<p>You can download them for testing purposes either manually
or in the terminal by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gdown<span class="w"> </span>https://drive.google.com/file/d/10S0H7HAnMmxHNpZLlifR14ykIuiXcBAD/view?usp<span class="o">=</span>sharing<span class="w"> </span>--fuzzy
</pre></div>
</div>
<p>You may need to install the python package <a class="reference external" href="https://github.com/wkentaro/gdown"><code class="docutils literal notranslate"><span class="pre">gdown</span></code></a>
for this to work:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>gdown
</pre></div>
</div>
<p>And then unzipping the downloaded file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unzip<span class="w"> </span>OpenNeuroPET-Demo_raw.zip
</pre></div>
</div>
<p>You can now look at the file tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>tree OpenNeuroPET-Demo_raw.

OpenNeuroPET-Demo_raw
│   .bidsignore
│   .DS_Store
│   dataset_description.json
│   README
│
├───code
│       .python_conversions.sh.swp
│       matlab_conversions.m
│       python_conversions.sh
│       README.md
│
├───source
│   │   .DS_Store
│   │
│   ├───SiemensBiographPETMR-NRU
│   │       X-CAL_7.PT.Kalibrering_xca.30003.1.2022.04.26.15.04.22.218.14689529.dcm
│   │       X-CAL_7.PT.Kalibrering_xca.30003.10.2022.04.26.15.04.22.218.14689628.dcm
│   │       X-CAL_7.PT.Kalibrering_xca.30003.100.2022.04.26.15.04.22.218.14690618.dcm
│   │       X-CAL_7.PT.Kalibrering_xca.30003.101.2022.04.26.15.04.22.218.14690629.dcm
│   │       ....
│   │
│   └───SiemensHRRT-NRU
│           XCal-Hrrt-2022.04.21.15.43.05_EM_3D.json
│           XCal-Hrrt-2022.04.21.15.43.05_EM_3D.v
│
├───sub-SiemensBiographNRU
│   └───pet
│           sub-SiemensBiographNRU_pet.json
│           sub-SiemensBiographNRU_pet.nii.gz
│
└───sub-SiemensHRRT
    └───pet
            sub-SiemensHRRT_pet.json
            sub-SiemensHRRT_pet.nii.gz
</pre></div>
</div>
<p>Now you have an example dataset where you have source data
(both for ECAT and DICOM PET image format)
and the PET BIDS data sets constructed for it.</p>
<p>Also if you have access to another PET image file format,
or data from a scanner not tested,
please reach out to <a class="reference external" href="https://openneuropet.github.io/">OpenNeuroPET project</a>
in order to add a phantom scan in your format.</p>
</div>
<div class="section" id="conversion">
<h2>Conversion<a class="headerlink" href="#conversion" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://openneuropet.github.io/">OpenNeuroPET project</a> has tried to develop tools
for facilitating easy data conversion for PET.
The main tool used for this is <a class="reference external" href="https://github.com/openneuropet/PET2BIDS">PET2BIDS</a>
freely available on the <a class="reference external" href="https://github.com/openneuropet">OpenNeuroPET GitHub repository</a>
along with other resources like altlases or pipelines.</p>
<p>It is available for both Python and MATLAB.
Eventually, <a class="reference external" href="https://github.com/openneuropet/PET2BIDS">PET2BIDS</a> will also be wrapped inside other BIDS conversion tools
such as <a class="reference external" href="https://github.com/Donders-Institute/bidscoin">BIDScoin</a> or
<a class="reference external" href="https://brainlife.io/ezbids/">ezBIDS</a>,
but this is work in progress at the moment.</p>
<p>Besides using <a class="reference external" href="https://github.com/openneuropet/PET2BIDS">PET2BIDS</a> there is always the possibility to manually convert a data set
to PET BIDS and an example will be shown below.
In any case, for DICOM data format, one relies on
<a class="reference external" href="https://www.nitrc.org/plugins/mwiki/index.php/dcm2nii:MainPage">dcm2niix</a>.</p>
<p>Below we will show two ways of converting your PET data to BIDS:</p>
<ol class="simple">
<li><p>using <a class="reference external" href="https://github.com/openneuropet/PET2BIDS">PET2BIDS</a> and</p></li>
<li><p>manually.</p></li>
</ol>
<div class="section" id="conversion-of-pet-data-using-pet2bids">
<h3>1) Conversion of PET data using PET2BIDS<a class="headerlink" href="#conversion-of-pet-data-using-pet2bids" title="Permalink to this headline">¶</a></h3>
<p>Detailed documentation for PET2BIDS can be found
<a class="reference external" href="https://pet2bids.readthedocs.io/en/latest/index.html">here</a> or on the
<a class="reference external" href="https://github.com/openneuropet/PET2BIDS/blob/main/README.md">Github repo</a>.</p>
<div class="section" id="get-dcm2niix">
<h4>get dcm2niix<a class="headerlink" href="#get-dcm2niix" title="Permalink to this headline">¶</a></h4>
<p>Download <a class="reference external" href="https://www.nitrc.org/plugins/mwiki/index.php/dcm2nii:MainPage">dcm2niix</a>,
and for Mac and Linux users you can add it to your path,
for instance it would could downloaded and unzipped into <code class="docutils literal notranslate"><span class="pre">/bin</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;/home/</span><span class="nv">$USER</span><span class="s2">/bin:</span><span class="nv">$PATH</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="for-python">
<h4>For Python<a class="headerlink" href="#for-python" title="Permalink to this headline">¶</a></h4>
<p>Open your terminal, either regular or anaconda terminal and type.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pypet2bids
</pre></div>
</div>
<p>Now you already have the converter installed and can go ahead
and convert your first dataset!</p>
<p>In this example, we are converting an image in DICOM format.
It should be noted that <code class="docutils literal notranslate"><span class="pre">pypet2bids</span></code> contains several different tools
and is itself a part of the larger PET library <code class="docutils literal notranslate"><span class="pre">PET2BIDS</span></code>,
the specific tool we will be using for the following DICOM conversion is <code class="docutils literal notranslate"><span class="pre">dcm2niix4pet</span></code>.</p>
<p>You just need to point <code class="docutils literal notranslate"><span class="pre">dcm2niix4pet</span></code> to:</p>
<ul class="simple">
<li><p>the folder where your data resides, <code class="docutils literal notranslate"><span class="pre">dcmfolder</span></code>, and</p></li>
<li><p>the folder where you want to output the PET BIDS formatted dataset, <code class="docutils literal notranslate"><span class="pre">mynewfolder</span></code>.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dcm2niix4pet<span class="w"> </span>dcmfolder<span class="w"> </span>-d<span class="w"> </span>mynewfolder
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">dcm2niix4pet</span></code> will do its best to extract as much information
about radiological and blood data from the DICOM files in the <code class="docutils literal notranslate"><span class="pre">dcmfolder</span></code>.
However, <code class="docutils literal notranslate"><span class="pre">dcm2niix4pet</span></code> can’t find information if it isn’t there,
hence it will often be up to you the user
to provide some missing information at the time of conversion.</p>
</div>
<p>Additional information can be provided via the command line
with the <code class="docutils literal notranslate"><span class="pre">--kwargs</span></code> argument in the form of key=pair values.
For an idea of what this looks like see below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dcm2niix4pet<span class="w"> </span>/OpenNeuroPET-Demo_raw/source/SiemensBiographPETMR-NRU<span class="w"> </span><span class="se">\</span>
<span class="w">            </span>-d<span class="w"> </span>mynewfolder<span class="w"> </span><span class="se">\</span>
<span class="w">            </span>--kwargs<span class="w">    </span><span class="nv">TimeZero</span><span class="o">=</span>ScanStart<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">Manufacturer</span><span class="o">=</span>Siemens<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">ManufacturersModelName</span><span class="o">=</span>Biograph<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">InstitutionName</span><span class="o">=</span><span class="s2">&quot;Rigshospitalet, NRU, DK&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">BodyPart</span><span class="o">=</span>Phantom<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">Units</span><span class="o">=</span>Bq/mL<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">TracerName</span><span class="o">=</span>none<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">TracerRadionuclide</span><span class="o">=</span>F18<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">InjectedRadioactivity</span><span class="o">=</span><span class="m">81</span>.24<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">SpecificRadioactivity</span><span class="o">=</span><span class="m">13019</span>.23<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">ModeOfAdministration</span><span class="o">=</span>infusion<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">FrameTimesStart</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">AcquisitionMode</span><span class="o">=</span><span class="s2">&quot;list mode&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">ImageDecayCorrected</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">ImageDecayCorrectionTime</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">AttenuationCorrection</span><span class="o">=</span>MR-corrected<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">FrameDuration</span><span class="o">=</span><span class="m">300</span><span class="w"> </span><span class="se">\</span>
<span class="w">                        </span><span class="nv">FrameTimesStart</span><span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p>Now you have a dataset in PET BIDS format.
You will probably have gotten some warnings relating to the <code class="docutils literal notranslate"><span class="pre">.json</span></code> sidecar file.
Carefully look at them, since they will help you to catch inconsistencies
and missing required fields that you need to add
in order for the dataset to pass the BIDS validator as well (see below how that’s done).
You can always edit the <code class="docutils literal notranslate"><span class="pre">.json</span></code> file, by opening it in a text editor and manually fixing errors.
Alternatively, adjust the meta structure you created above to correct the errors.</p>
</div>
<div class="section" id="for-matlab">
<h4>For MATLAB<a class="headerlink" href="#for-matlab" title="Permalink to this headline">¶</a></h4>
<p>Download/Clone the <a class="reference external" href="https://github.com/openneuropet/PET2BIDS">PET2BIDS</a> GitHub repository.
Windows users must, in addition, indicate the full path of where is the <code class="docutils literal notranslate"><span class="pre">dcm2niix.exe</span></code> in
<a class="reference external" href="https://github.com/openneuropet/PET2BIDS/blob/main/matlab/dcm2niix4pet.m#L42">dcm2niix4pet.m</a>.</p>
<p>Then, just follow the
<a class="reference external" href="https://github.com/openneuropet/PET2BIDS/blob/main/matlab/Readme.md">MATLAB README</a>.
In the following it is just described how to convert DICOM files.
It’s very similar and described in the
<a class="reference external" href="https://github.com/openneuropet/PET2BIDS/blob/main/matlab/Readme.md">MATLAB README</a>
how to handle ECAT files.</p>
<p>The entire PET2BIDS repository or only the MATLAB subfolder (your choice) should be in your MATLAB path.</p>
<p>Defaults parameters can be set in <code class="docutils literal notranslate"><span class="pre">(scannername).txt</span></code> files to generate metadata easily
(meaning to avoid passing all arguments in although this is also possible).
You can find templates of such parameter file under
<a class="reference external" href="https://github.com/openneuropet/PET2BIDS/tree/main/matlab/template_txt"><code class="docutils literal notranslate"><span class="pre">/template_txt</span></code></a>:</p>
<ul class="simple">
<li><p>SiemensHRRTparameters.txt,</p></li>
<li><p>SiemensBiographparameters.txt,</p></li>
<li><p>GEAdvanceparameters.txt,</p></li>
<li><p>PhilipsVereosparameters.txt.</p></li>
</ul>
<p>Now in order to convert a PET dataset on disk to PET BIDS,
one creates a structure containing all the meta information (here passing on all arguments)
and then point the function to the folder where your data resides <code class="docutils literal notranslate"><span class="pre">dcmfolder</span></code>
and the folder where you want to output the PET BIDS formatted dataset <code class="docutils literal notranslate"><span class="pre">mynewfolder</span></code>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">get_pet_metadata</span><span class="p">(</span><span class="s">&#39;Scanner&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SiemensBiograph&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;TimeZero&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ScanStart&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;TracerName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;CB36&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;TracerRadionuclide&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;C11&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ModeOfAdministration&#39;</span><span class="p">,</span><span class="w">  </span><span class="s">&#39;infusion&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;SpecificRadioactivity&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">605.3220</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;InjectedMass&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5934</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;MolarActivity&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">107.66</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;InstitutionName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Rigshospitalet, NRU, DK&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;AcquisitionMode&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;list mode&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ImageDecayCorrected&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;true&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ImageDecayCorrectionTime&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ReconMethodName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;OP-OSEM&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ReconMethodParameterLabels&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;subsets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;iterations&#39;</span><span class="p">},</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ReconMethodParameterUnits&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;none&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;none&#39;</span><span class="p">},</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ReconMethodParameterValues&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">21</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ReconFilterType&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;XYZGAUSSIAN&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ReconFilterSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;AttenuationCorrection&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;CT-based attenuation correction&#39;</span><span class="p">);</span>

<span class="n">dcm2niix4pet</span><span class="p">(</span><span class="n">dcmfolder</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;o&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mynewfolder</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">get_pet_metadata</span></code> can be called in a much simpler way
if you have a <code class="docutils literal notranslate"><span class="pre">\*parameters.txt</span></code> seating on disk next to this function.
The call would then looks like:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% your SiemensBiographparameters.txt file is stored next to get_pet_metadata.m</span>
<span class="n">meta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">get_pet_metadata</span><span class="p">(</span><span class="s">&#39;Scanner&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SiemensBiograph&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;TimeZero&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ScanStart&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;TracerName&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;CB36&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;TracerRadionuclide&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;C11&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;ModeOfAdministration&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;infusion&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;SpecificRadioactivity&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">605.3220</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;InjectedMass&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5934</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                        </span><span class="s">&#39;MolarActivity&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">107.66</span><span class="p">);</span>

<span class="n">dcm2niix4pet</span><span class="p">(</span><span class="n">dcmfolder</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;o&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mynewfolder</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>Now you have a dataset in PET BIDS format.
You will probably have gotten some warnings relating to the <code class="docutils literal notranslate"><span class="pre">.json</span></code> sidecar file.
Carefully look at them, since they will help you to catch inconsistencies
and missing required fields that you need to add
in order for the dataset to pass the BIDS validator as well (see below how that’s done).</p>
<p>You can always edit the <code class="docutils literal notranslate"><span class="pre">.json</span></code> file, by opening it in a text editor and manually fixing errors.</p>
<p>Alternatively, adjust the meta structure you created above to correct the errors.</p>
</div>
</div>
<div class="section" id="manual-conversion-of-pet-data-to-pet-bids">
<h3>2) Manual conversion of PET data to PET BIDS<a class="headerlink" href="#manual-conversion-of-pet-data-to-pet-bids" title="Permalink to this headline">¶</a></h3>
<p>As stated above PET files come of the scanner in various formats.
In the following manual data conversion is shown for an ECAT (.v)
as well as a DICOM (.dcm) PET image dataset.</p>
<div class="section" id="pet-image-data-in-ecat-format">
<h4>PET image data in ECAT format<a class="headerlink" href="#pet-image-data-in-ecat-format" title="Permalink to this headline">¶</a></h4>
<p>Here is the structure of our starting dataset:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>OldNotBidsPETDataSet/
├──<span class="w"> </span>MR_image
│<span class="w">   </span>├──<span class="w"> </span><span class="m">24310</span>.cropped.hdr
│<span class="w">   </span>├──<span class="w"> </span><span class="m">24310</span>.cropped.img
│<span class="w">   </span>└──<span class="w"> </span>24310_rois.mat
├──<span class="w"> </span>retest_scan_sub01
│<span class="w">   </span>├──<span class="w"> </span>sub01_8__PLASMA.txt
│<span class="w">   </span>└──<span class="w"> </span>sub01_8_anon.v
└──<span class="w"> </span>test_scan_sub01
<span class="w">    </span>├──<span class="w"> </span>sub01_7_PLASMA.txt
<span class="w">    </span>└──<span class="w"> </span>sub01_7_anon.v

<span class="m">3</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">7</span><span class="w"> </span>files
</pre></div>
</div>
<p>By the end of this document our starting dataset will be fully BIDS compliant
and similar to the dataset seen
<a class="reference external" href="https://github.com/bids-standard/bids-examples/tree/master/pet001">here</a>.</p>
</div>
<div class="section" id="setting-the-layout">
<h4>Setting the layout<a class="headerlink" href="#setting-the-layout" title="Permalink to this headline">¶</a></h4>
<p>This starter kit provides several template/example files
that can be a great starting place to help get set up for the conversion process.
PET specific text data files can be viewed at
<a class="reference external" href="https://github.com/bids-standard/bids-starter-kit/tree/main/templates/sub-01/ses-01/pet">this location</a>.
and easily collected via this
<a class="reference external" href="https://github.com/bids-standard/bids-starter-kit/archive/refs/heads/main.zip">link</a>
or be cloned and extracted via git at the command line via:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:bids-standard/bids-starter-kit.git
</pre></div>
</div>
<p>The <a class="reference external" href="https://github.com/bids-standard/bids-starter-kit/tree/main/templates/sub-01/ses-01/pet"><code class="docutils literal notranslate"><span class="pre">templates/</span></code></a> folder in <code class="docutils literal notranslate"><span class="pre">bids-starter-kit/</span></code> contains a single subject
and examples of every BIDS modality text and <code class="docutils literal notranslate"><span class="pre">.json</span></code> file for that subject.
Additionally, there exists a <code class="docutils literal notranslate"><span class="pre">Short</span></code> and a <code class="docutils literal notranslate"><span class="pre">Full</span></code> example for each text/json file.
The <code class="docutils literal notranslate"><span class="pre">Short</span></code> files contain only the required BIDS fields for each modality
and the <code class="docutils literal notranslate"><span class="pre">Full</span></code> example files contain <em>every</em> field included within the BIDS standard.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>templates/
├──<span class="w"> </span>README
├──<span class="w"> </span>dataset_description.json
├──<span class="w"> </span>participants.json
├──<span class="w"> </span>participants.tsv
├──<span class="w"> </span>phenotype
│<span class="w">   </span>├──<span class="w"> </span>EpilepsyClassification.tsv
│<span class="w">   </span>└──<span class="w"> </span>EpilepsyClassification2017.json
└──<span class="w"> </span>sub-01
<span class="w">    </span>└──<span class="w"> </span>ses-01
<span class="w">        </span>├──<span class="w"> </span>anat
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_acq-FullExample_run-01_T1w.json
<span class="w">        </span>│<span class="w">   </span>└──<span class="w"> </span>sub-01_ses-01_acq-ShortExample_run-01_T1w.json
<span class="w">        </span>├──<span class="w"> </span>eeg
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-FilterExample_eeg.json
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-FullExample_eeg.json
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-MinimalExample_eeg.json
<span class="w">        </span>│<span class="w">   </span>└──<span class="w"> </span>sub-01_ses-01_task-ReferenceExample_eeg.json
<span class="w">        </span>├──<span class="w"> </span>fmap
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-Case1_run-01_phasediff.json
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-Case2_run-01_phase1.json
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-Case2_run-01_phase2.json
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-Case3_run-01_fieldmap.json
<span class="w">        </span>│<span class="w">   </span>└──<span class="w"> </span>sub-01_ses-01_task-Case4_dir-LR_run-01_epi.json
<span class="w">        </span>├──<span class="w"> </span>func
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-FullExample_run-01_bold.json
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-FullExample_run-01_events.json
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-FullExample_run-01_events.tsv
<span class="w">        </span>│<span class="w">   </span>└──<span class="w"> </span>sub-01_ses-01_task-ShortExample_run-01_bold.json
<span class="w">        </span>├──<span class="w"> </span>ieeg
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_coordsystem.json
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_electrodes.tsv
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-01_task-LongExample_run-01_channels.tsv
<span class="w">        </span>│<span class="w">   </span>└──<span class="w"> </span>sub-01_ses-01_task-LongExample_run-01_ieeg.json
<span class="w">        </span>├──<span class="w"> </span>meg
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_task-FullExample_acq-CTF_run-1_proc-sss_meg.json
<span class="w">        </span>│<span class="w">   </span>└──<span class="w"> </span>sub-01_task-ShortExample_acq-CTF_run-1_proc-sss_meg.json
<span class="w">        </span>└──<span class="w"> </span>pet
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-AutosamplerShortExample_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-AutosamplerShortExample_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualFullExample_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualFullExample_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualShortExample_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualShortExample_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_task-FullExample_pet.json
<span class="w">            </span>└──<span class="w"> </span>sub-01_ses-01_task-ShortExample_pet.json

<span class="m">10</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">35</span><span class="w"> </span>files
machine:bids-starter-kit<span class="w"> </span>user$
</pre></div>
</div>
<p>For the purposes of this exercise we will only be focusing on obtaining the minimum required fields,
thus we collect and copy the following to our own BIDS folder.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the new BIDS folder</span>
mkdir<span class="w"> </span>-p<span class="w"> </span>/NewBidsDataSet/sub-01/ses-01/pet
cp<span class="w"> </span>-r<span class="w"> </span>/path/to/bids-starter-kit/templates/sub-01/ses-01/pet/*<span class="w"> </span>/NewBidsDataSet/sub-01/pet/
</pre></div>
</div>
<p>Oops, we forgot to include our dataset specific files.
Let’s make it easy on ourselves and include the templates for those too.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>/path/to/bids-starter-kit/templates/*<span class="w"> </span>/NewBidsDataSet/
</pre></div>
</div>
<p>Our skeleton of a data set should now look like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>machine:<span class="w"> </span>Projects<span class="w"> </span>user$<span class="w"> </span>tree<span class="w"> </span>NewBidsDataSet/
NewBidsDataSet/
├──<span class="w"> </span>README
├──<span class="w"> </span>dataset_description.json
├──<span class="w"> </span>participants.json
├──<span class="w"> </span>participants.tsv
└──<span class="w"> </span>sub-01
<span class="w">    </span>└──<span class="w"> </span>ses-01
<span class="w">        </span>└──<span class="w"> </span>pet
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-AutosamplerShortExample_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-AutosamplerShortExample_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualFullExample_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualFullExample_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualShortExample_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualShortExample_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_task-FullExample_pet.json
<span class="w">            </span>└──<span class="w"> </span>sub-01_ses-01_task-ShortExample_pet.json

<span class="m">3</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">12</span><span class="w"> </span>files
machine:Projects<span class="w"> </span>user$
</pre></div>
</div>
<p>Now let’s do the bare minimum and focus only on the short files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>machine:Projects<span class="w"> </span>user$<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>NewBidsDataSet/sub-01/ses-01/pet/*Full*
machine:Projects<span class="w"> </span>user$<span class="w"> </span>tree<span class="w"> </span>NewBidsDataSet
NewBidsDataSet/
├──<span class="w"> </span>README
├──<span class="w"> </span>dataset_description.json
├──<span class="w"> </span>participants.json
├──<span class="w"> </span>participants.tsv
└──<span class="w"> </span>sub-01
<span class="w">    </span>└──<span class="w"> </span>ses-01
<span class="w">        </span>└──<span class="w"> </span>pet
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-AutosamplerShortExample_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-AutosamplerShortExample_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualShortExample_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-ManualShortExample_blood.tsv
<span class="w">            </span>└──<span class="w"> </span>sub-01_ses-01_task-ShortExample_pet.json

<span class="m">3</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">9</span><span class="w"> </span>files
machine:Projects<span class="w"> </span>user$
</pre></div>
</div>
<p>That certainly looks less daunting, now let’s change the filenames of the templates
so that they make more sense for our data set (by removing <code class="docutils literal notranslate"><span class="pre">ShortExample</span></code> from each filename).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have multiple PET image files you can distinguish between them
by creating a session folder with a unique name
and then applying the <code class="docutils literal notranslate"><span class="pre">ses-&lt;label&gt;</span></code> label to each file therein.
If there’s a single pet scan you may omit the additional folder
and corresponding label(s) from the filename.
For more information on labeling see <a class="reference external" href="https://bids-specification.readthedocs.io/en/stable/04-modality-specific-files/09-positron-emission-tomography.html#pet-recording-data">this link</a>.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># for those of you in bash land</span>
machine:Projects<span class="w"> </span>user$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>NewBidsDataSet/sub-01/ses-01/pet
machine:pet<span class="w"> </span>user$<span class="w"> </span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span>*ShortExample*<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>mv<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;`echo </span><span class="nv">$i</span><span class="s2"> | sed &#39;s/ShortExample//&#39;`&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>

<span class="c1"># Since we &quot;don&#39;t&quot; know if there are multiple PET image files </span>
<span class="c1"># we will omit the task label for our PET .json file for now.</span>
machine:pet<span class="w"> </span>user$<span class="w"> </span>mv<span class="w"> </span>sub-01_ses-01_task-_pet.json<span class="w"> </span>sub-01-ses-01_pet.json
</pre></div>
</div>
<p>After you’ve renamed your files your directory should look something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>machine:Projects<span class="w"> </span>user$<span class="w"> </span>tree<span class="w"> </span>NewBidsDataSet/
NewBidsDataSet/
├──<span class="w"> </span>README
├──<span class="w"> </span>dataset_description.json
├──<span class="w"> </span>participants.json
├──<span class="w"> </span>participants.tsv
└──<span class="w"> </span>sub-01
<span class="w">    </span>└──<span class="w"> </span>ses-01
<span class="w">        </span>└──<span class="w"> </span>pet
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_pet.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-Autosampler_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-Autosampler_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-Manual_blood.json
<span class="w">            </span>└──<span class="w"> </span>sub-01_ses-01_recording-Manual_blood.tsv

<span class="m">3</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">9</span><span class="w"> </span>files
machine:Projects<span class="w"> </span>user$
</pre></div>
</div>
<p>Ok great, but where do the imaging files go?
And what format should they be in?
And there’s at least 2 <code class="docutils literal notranslate"><span class="pre">.v</span></code> pet files shouldn’t there be multiple sessions?</p>
<p>Well yes, yes, and yes. but before we add more sessions/directories
we’re going to make sure we have images to place in them.</p>
</div>
<div class="section" id="collecting-and-installing-tpcclib">
<h4>Collecting and installing TPCCLIB<a class="headerlink" href="#collecting-and-installing-tpcclib" title="Permalink to this headline">¶</a></h4>
<p>Since our raw imaging files are in ECAT format,
we’ll be using the <code class="docutils literal notranslate"><span class="pre">ecat2nii</span></code> tool it the Turku PET Centre C library (<code class="docutils literal notranslate"><span class="pre">TPCCLIIB</span></code>)
as it’s very handy at converting PET ECAT images into the more BIDS friendly nifti format.
If you’re imaging files are in <code class="docutils literal notranslate"><span class="pre">.IMG</span></code> you can use **&lt;\insert converter&gt;**
or if they’re in DICOM <code class="docutils literal notranslate"><span class="pre">dcm2niix</span></code> is an excellent tool to transform <code class="docutils literal notranslate"><span class="pre">.dcm</span></code> files into <code class="docutils literal notranslate"><span class="pre">.nii</span></code>.</p>
<p>Before we proceed we will need to collect and install the <code class="docutils literal notranslate"><span class="pre">ecat2nii</span></code> tool from the <code class="docutils literal notranslate"><span class="pre">TPCCLIIB</span></code> a container,
or a VM if you want to continue following along.</p>
<p>If you’re on a non-posix based OS, we suggest you use WSL (windows subsystem for linux).</p>
<ol class="simple">
<li><p>Visit <a class="reference external" href="https://gitlab.utu.fi/vesoik/tpcclib">https://gitlab.utu.fi/vesoik/tpcclib</a></p></li>
<li><p>Download tpcclib via your download link of choice, ours is
<a class="reference external" href="https://gitlab.utu.fi/vesoik/tpcclib/-/archive/master/tpcclib-master.zip">here</a></p></li>
<li><p>Once downloaded extract and place <code class="docutils literal notranslate"><span class="pre">ecat2nii</span></code> in an appropriate place</p></li>
</ol>
<p>If you’re using bash/posix step 3 will resemble something like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>machine:Downloads<span class="w"> </span>user$<span class="w"> </span>unzip<span class="w"> </span>tpcclib-master.zip
machine:Downloads<span class="w"> </span>user$<span class="w"> </span>mv<span class="w"> </span>tpcclib-master<span class="w"> </span>/some/directory/you/are/fond/of/<span class="w"> </span><span class="c1"># could be /usr/bin if you so choose</span>
</pre></div>
</div>
<p>Now you can choose to add <code class="docutils literal notranslate"><span class="pre">tpcclib</span></code> to your path or not, in bash land we do the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>machine:Downloads<span class="w"> </span>user$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export PATH=</span><span class="nv">$PATH</span><span class="s2">:/some/directory/you/are/fond/of/tpcclib-master&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc

<span class="c1"># reload bash shell and verify that library is available</span>
machine:Downloads<span class="w"> </span>user$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>~/.bashrc

machine:Downloads<span class="w"> </span>user$<span class="w"> </span>ecat2nii
<span class="w">  </span>ecat2nii<span class="w"> </span>-<span class="w"> </span>tpcclib<span class="w"> </span><span class="m">0</span>.7.6<span class="w"> </span><span class="o">(</span>c<span class="o">)</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span>by<span class="w"> </span>Turku<span class="w"> </span>PET<span class="w"> </span>Centre

<span class="w">  </span>Converts<span class="w"> </span>PET<span class="w"> </span>images<span class="w"> </span>from<span class="w"> </span>ECAT<span class="w"> </span><span class="m">6</span>.3<span class="w"> </span>or<span class="w"> </span><span class="m">7</span><span class="w"> </span>to<span class="w"> </span>NIfTI-1<span class="w"> </span>format.
<span class="w">  </span>Conversion<span class="w"> </span>can<span class="w"> </span>also<span class="w"> </span>be<span class="w"> </span><span class="k">done</span><span class="w"> </span>using<span class="w"> </span>ImageConverter<span class="w"> </span><span class="o">(</span>.NET<span class="w"> </span>application<span class="o">)</span>.

<span class="w">  </span>Image<span class="w"> </span>byte<span class="w"> </span>order<span class="w"> </span>is<span class="w"> </span>determined<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>computer<span class="w"> </span>where<span class="w"> </span>the<span class="w"> </span>program<span class="w"> </span>is<span class="w"> </span>run.
<span class="w">  </span>NIfTI<span class="w"> </span>image<span class="w"> </span>format<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>contain<span class="w"> </span>information<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>frame<span class="w"> </span>times.
<span class="w">  </span>Frame<span class="w"> </span><span class="nb">times</span><span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>retrieved<span class="w"> </span>from<span class="w"> </span>SIF<span class="w"> </span>file,<span class="w"> </span>which<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>created<span class="w"> </span>optionally.
<span class="w">  </span>SIF<span class="w"> </span>can<span class="w"> </span>also<span class="w"> </span>be<span class="w"> </span>created<span class="w"> </span>later<span class="w"> </span>using<span class="w"> </span>other<span class="w"> </span>software.

<span class="w">  </span>Usage:<span class="w"> </span>ecat2nii<span class="w"> </span><span class="o">[</span>Options<span class="o">]</span><span class="w"> </span>ecatfile<span class="o">(</span>s<span class="o">)</span>

<span class="w">  </span>Options:
<span class="w">   </span>-O<span class="o">=</span>&lt;output<span class="w"> </span>path&gt;
<span class="w">       </span>Data<span class="w"> </span>directory<span class="w"> </span><span class="k">for</span><span class="w"> </span>NIfTI<span class="w"> </span>files,<span class="w"> </span><span class="k">if</span><span class="w"> </span>other<span class="w"> </span>than<span class="w"> </span>the<span class="w"> </span>current<span class="w"> </span>working<span class="w"> </span>path.
<span class="w">   </span>-dual
<span class="w">       </span>Save<span class="w"> </span>the<span class="w"> </span>image<span class="w"> </span><span class="k">in</span><span class="w"> </span>dual<span class="w"> </span>file<span class="w"> </span>format<span class="w"> </span><span class="o">(</span>the<span class="w"> </span>header<span class="w"> </span>and<span class="w"> </span>voxel<span class="w"> </span>data<span class="w"> </span><span class="k">in</span>
<span class="w">       </span>separate<span class="w"> </span>files<span class="w"> </span>*.hdr<span class="w"> </span>and<span class="w"> </span>*.img<span class="o">)</span><span class="p">;</span><span class="w"> </span>single<span class="w"> </span>file<span class="w"> </span>format<span class="w"> </span><span class="o">(</span>*.nii<span class="o">)</span>
<span class="w">       </span>is<span class="w"> </span>the<span class="w"> </span>default.
<span class="w">   </span>-sif
<span class="w">       </span>SIF<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>with<span class="w"> </span>NIfTI<span class="p">;</span><span class="w"> </span>note<span class="w"> </span>that<span class="w"> </span>existing<span class="w"> </span>SIF<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>overwritten.
<span class="w">   </span>-h,<span class="w"> </span>--help
<span class="w">       </span>Display<span class="w"> </span>usage<span class="w"> </span>information<span class="w"> </span>on<span class="w"> </span>standard<span class="w"> </span>output<span class="w"> </span>and<span class="w"> </span>exit.
<span class="w">   </span>-v,<span class="w"> </span>--version
<span class="w">       </span>Display<span class="w"> </span>version<span class="w"> </span>and<span class="w"> </span>compile<span class="w"> </span>information<span class="w"> </span>on<span class="w"> </span>standard<span class="w"> </span>output<span class="w"> </span>and<span class="w"> </span>exit.
<span class="w">   </span>-d<span class="o">[</span>n<span class="o">]</span>,<span class="w"> </span>--debug<span class="o">[=</span>n<span class="o">]</span>,<span class="w"> </span>--verbose<span class="o">[=</span>n<span class="o">]</span>
<span class="w">       </span>Set<span class="w"> </span>the<span class="w"> </span>level<span class="w"> </span><span class="o">(</span>n<span class="o">)</span><span class="w"> </span>of<span class="w"> </span>debugging<span class="w"> </span>messages<span class="w"> </span>and<span class="w"> </span>listings.
<span class="w">   </span>-q,<span class="w"> </span>--quiet
<span class="w">       </span>Suppress<span class="w"> </span>displaying<span class="w"> </span>normal<span class="w"> </span>results<span class="w"> </span>on<span class="w"> </span>standard<span class="w"> </span>output.
<span class="w">   </span>-s,<span class="w"> </span>--silent
<span class="w">       </span>Suppress<span class="w"> </span>displaying<span class="w"> </span>anything<span class="w"> </span>except<span class="w"> </span>errors.

<span class="w">  </span>Example:
<span class="w">    </span>ecat2nii<span class="w"> </span>*.v

<span class="w">  </span>See<span class="w"> </span>also:<span class="w"> </span>nii2ecat,<span class="w"> </span>nii_lhdr,<span class="w"> </span>ecat2ana,<span class="w"> </span>eframe,<span class="w"> </span>img2flat

<span class="w">  </span>Keywords:<span class="w"> </span>image,<span class="w"> </span>format<span class="w"> </span>conversion,<span class="w"> </span>ECAT,<span class="w"> </span>NIfTI

<span class="w">  </span>This<span class="w"> </span>program<span class="w"> </span>comes<span class="w"> </span>with<span class="w"> </span>ABSOLUTELY<span class="w"> </span>NO<span class="w"> </span>WARRANTY.
<span class="w">  </span>This<span class="w"> </span>is<span class="w"> </span>free<span class="w"> </span>software,<span class="w"> </span>and<span class="w"> </span>you<span class="w"> </span>are<span class="w"> </span>welcome<span class="w"> </span>to<span class="w"> </span>redistribute<span class="w"> </span>it<span class="w"> </span>under
<span class="w">  </span>GNU<span class="w"> </span>General<span class="w"> </span>Public<span class="w"> </span>License.<span class="w"> </span>Source<span class="w"> </span>codes<span class="w"> </span>are<span class="w"> </span>available<span class="w"> </span><span class="k">in</span>
<span class="w">  </span>https://gitlab.utu.fi/vesoik/tpcclib.git
</pre></div>
</div>
<p>Congrats, you’ve installed <code class="docutils literal notranslate"><span class="pre">ecat2nii</span></code>, you’re one step closer to bidsifying your dataset</p>
<p>Now, let’s convert one of our PET ECAT images
and move it to its final destination with <code class="docutils literal notranslate"><span class="pre">ecat2nii</span></code> that we just installed.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># first create nifti&#39;s from the ecat images</span>
machine:OldNotBidsPETDataSet<span class="w"> </span>user$<span class="w"> </span>ecat2nii<span class="w"> </span>retest_scan_sub01/sub01_8_anon.v
retest_scan_sub01/sub01_8_anon.v<span class="w"> </span>:
<span class="w">  </span>processing<span class="w"> </span>retest_scan_sub01/sub01_8_anon.v
<span class="w">  </span><span class="m">45</span><span class="w"> </span>frame<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>processed.

machine:OldNotBidsPETDataSet<span class="w"> </span>user$<span class="w"> </span>ecat2nii<span class="w"> </span>test_scan_sub01/sub01_7_anon.v
test_scan_sub01/sub01_7_anon.v<span class="w"> </span>:
<span class="w">  </span>processing<span class="w"> </span>test_scan_sub01/sub01_7_anon.v
<span class="w">  </span><span class="m">45</span><span class="w"> </span>frame<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>processed.

<span class="c1"># great success! let&#39;s see what we got</span>
machine:OldNotBidsPETDataSet<span class="w"> </span>user$<span class="w"> </span>tree
.
├──<span class="w"> </span>MR_image
│<span class="w">   </span>├──<span class="w"> </span><span class="m">24310</span>.cropped.hdr
│<span class="w">   </span>├──<span class="w"> </span><span class="m">24310</span>.cropped.img
│<span class="w">   </span>└──<span class="w"> </span>24310_rois.mat
├──<span class="w"> </span>retest_scan_sub01
│<span class="w">   </span>├──<span class="w"> </span>sub01_8_PLASMA.txt
│<span class="w">   </span>└──<span class="w"> </span>sub01_8_anon.v
├──<span class="w"> </span>sub01_7_anon.nii
├──<span class="w"> </span>sub01_8_anon.nii
└──<span class="w"> </span>test_scan_sub01
<span class="w">    </span>├──<span class="w"> </span>sub01_7_PLASMA.txt
<span class="w">    </span>└──<span class="w"> </span>sub01_7_anon.v

<span class="m">3</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">9</span><span class="w"> </span>files

<span class="c1"># not where we want those nifti&#39;s so let&#39;s move them</span>
machine:OldNotBidsPETDataSet<span class="w"> </span>user$<span class="w"> </span>mv<span class="w"> </span>*.nii<span class="w"> </span>../NewBidsDataSet/sub-01/

machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>tree
.
├──<span class="w"> </span>README
├──<span class="w"> </span>dataset_description.json
├──<span class="w"> </span>participants.json
├──<span class="w"> </span>participants.tsv
└──<span class="w"> </span>sub-01
<span class="w">    </span>└──<span class="w"> </span>test_scan_sub01/sub01_7_anon.nii
<span class="w">    </span>└──<span class="w"> </span>test_scan_sub01/sub01_8_anon.nii
<span class="w">    </span>└──<span class="w"> </span>ses-01
<span class="w">        </span>└──<span class="w"> </span>pet
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_pet.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-Autosampler_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-Autosampler_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-Manual_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-01_recording-Manual_blood.tsv

<span class="m">3</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">11</span><span class="w"> </span>files
</pre></div>
</div>
<p>Before we get too carried away, lets use populate our <code class="docutils literal notranslate"><span class="pre">*_pet.json</span></code> files
with the relevant information from our ECAT and dataset.</p>
<p>This writer used a python tool specifically created to parse ECAT’s
for header and subheader info <a class="reference external" href="https://github.com/bendhouseart/ecatdump">ecatdump</a>.
All it does is use Python libraries Nibabel and Argparse
to collect and spit out the header information from an ECAT file.</p>
<p>You can use and install it via pip and use it on your command line like below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>ecatdump

<span class="c1"># use the --json argument to extract all metadata contained in the ecat including subheaders</span>
ecatdump<span class="w">  </span>anon_sub01_8.v<span class="w"> </span>--json<span class="w"> </span>&gt;<span class="w"> </span>sub01_8_anon.headerdata

<span class="c1"># using it without the --json argument will produce this output</span>
ecat<span class="w"> </span>dump<span class="w"> </span>anon_sub01_8.v
magic_number:<span class="w"> </span>MATRIX72v
original_filename:<span class="w"> </span>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
sw_version:<span class="w"> </span><span class="m">72</span>
system_type:<span class="w"> </span><span class="m">962</span>
file_type:<span class="w"> </span><span class="m">7</span>
serial_number:<span class="w"> </span>hrplus
scan_start_time:<span class="w"> </span><span class="m">1111111111111</span>
isotope_name:<span class="w"> </span>C-11
isotope_halflife:<span class="w"> </span><span class="m">1223</span>.0
radiopharmaceutical:<span class="w"> </span>C-11<span class="w"> </span>Flumazenil
gantry_tilt:<span class="w"> </span><span class="m">0</span>.0
gantry_rotation:<span class="w"> </span><span class="m">0</span>.0
bed_elevation:<span class="w"> </span><span class="m">82</span>.6520004272461
intrinsic_tilt:<span class="w"> </span><span class="m">0</span>.0
wobble_speed:<span class="w"> </span><span class="m">0</span>
transm_source_type:<span class="w"> </span><span class="m">2</span>
distance_scanned:<span class="w"> </span><span class="m">15</span>.520000457763672
transaxial_fov:<span class="w"> </span><span class="m">58</span>.29999923706055
angular_compression:<span class="w"> </span><span class="m">1</span>
coin_samp_mode:<span class="w"> </span><span class="m">0</span>
axial_samp_mode:<span class="w"> </span><span class="m">0</span>
ecat_calibration_factor:<span class="w"> </span><span class="m">9698905</span>.0
calibration_unitS:<span class="w"> </span><span class="m">1</span>
calibration_units_type:<span class="w"> </span><span class="m">1</span>
compression_code:<span class="w"> </span><span class="m">0</span>
study_type:<span class="w"> </span>XXXXXXXXXXXX
patient_id:<span class="w"> </span><span class="m">0000000000000000</span>
patient_name:<span class="w"> </span>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
patient_sex:<span class="w"> </span>F
patient_dexterity:<span class="w"> </span>U
patient_age:<span class="w"> </span><span class="m">0</span>.0
patient_height:<span class="w"> </span><span class="m">0</span>.0
patient_weight:<span class="w"> </span><span class="m">0</span>.0
patient_birth_date:<span class="w"> </span><span class="m">0</span>
physician_name:
operator_name:
study_description:<span class="w"> </span>C-11<span class="w"> </span>Dynamic-1
acquisition_type:<span class="w"> </span><span class="m">4</span>
patient_orientation:<span class="w"> </span><span class="m">3</span>
facility_name:<span class="w"> </span>ECAT
num_planes:<span class="w"> </span><span class="m">63</span>
num_frames:<span class="w"> </span><span class="m">20</span>
num_gates:<span class="w"> </span><span class="m">1</span>
num_bed_pos:<span class="w"> </span><span class="m">0</span>
init_bed_position:<span class="w"> </span><span class="m">50</span>.617000579833984
bed_position:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0<span class="o">]</span>
plane_separation:<span class="w"> </span><span class="m">0</span>.24250000715255737
lwr_sctr_thres:<span class="w"> </span><span class="m">0</span>
lwr_true_thres:<span class="w"> </span><span class="m">350</span>
upr_true_thres:<span class="w"> </span><span class="m">650</span>
user_process_code:
acquisition_mode:<span class="w"> </span><span class="m">0</span>
bin_size:<span class="w"> </span><span class="m">0</span>.22499999403953552
branching_fraction:<span class="w"> </span><span class="m">1</span>.0
dose_start_time:<span class="w"> </span><span class="m">111111111111</span>
dosage:<span class="w"> </span><span class="m">0</span>.0
well_counter_corr_factor:<span class="w"> </span><span class="m">1</span>.0
data_units:
septa_state:<span class="w"> </span><span class="m">1</span>
fill:
</pre></div>
</div>
<p>Using nibabel directly also works great:</p>
<!--
machine:retest_scan_anon_sub01_8 user$ python3
Python 3.7.3 (default, Mar 27 2019, 09:23:15)
[Clang 10.0.1 (clang-1001.0.46.3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nibabel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ecat_file</span> <span class="o">=</span> <span class="n">nibabel</span><span class="o">.</span><span class="n">ecat</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;anon_sub01_8_43e5_1b831_de2_anon.v&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ecat_file</span><span class="o">.</span><span class="n">get_header</span><span class="p">())</span>
<span class="go">__main__:1: DeprecationWarning: get_header method is deprecated.</span>
<span class="go">Please use the ``img.header`` property instead.</span>

<span class="go">* deprecated from version: 2.1</span>
<span class="go">* Will raise &lt;class &#39;nibabel.deprecator.ExpiredDeprecationError&#39;&gt; as of version: 4.0</span>
<span class="go">&lt;class &#39;nibabel.ecat.EcatHeader&#39;&gt; object, endian=&#39;&gt;&#39;</span>
<span class="go">magic_number              : b&#39;MATRIX72v&#39;</span>
<span class="go">original_filename         : b&#39;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#39;</span>
<span class="go">sw_version                : 72</span>
<span class="go">system_type               : 962</span>
<span class="go">file_type                 : 7</span>
<span class="go">serial_number             : b&#39;hrplus&#39;</span>
<span class="go">scan_start_time           : 1111111111</span>
<span class="go">isotope_name              : b&#39;C-11&#39;</span>
<span class="go">isotope_halflife          : 1223.0</span>
<span class="go">radiopharmaceutical       : b&#39;C-11 Flumazenil&#39;</span>
<span class="go">gantry_tilt               : 0.0</span>
<span class="go">gantry_rotation           : 0.0</span>
<span class="go">bed_elevation             : 82.652</span>
<span class="go">intrinsic_tilt            : 0.0</span>
<span class="go">wobble_speed              : 0</span>
<span class="go">transm_source_type        : 2</span>
<span class="go">distance_scanned          : 15.52</span>
<span class="go">transaxial_fov            : 58.3</span>
<span class="go">angular_compression       : 1</span>
<span class="go">coin_samp_mode            : 0</span>
<span class="go">axial_samp_mode           : 0</span>
<span class="go">ecat_calibration_factor   : 9698905.0</span>
<span class="go">calibration_unitS         : 1</span>
<span class="go">calibration_units_type    : 1</span>
<span class="go">compression_code          : 0</span>
<span class="go">study_type                : b&#39;XXXXXXXXXXXX&#39;</span>
<span class="go">patient_id                : b&#39;0000000000000000&#39;</span>
<span class="go">patient_name              : b&#39;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#39;</span>
<span class="go">patient_sex               : b&#39;F&#39;</span>
<span class="go">patient_dexterity         : b&#39;U&#39;</span>
<span class="go">patient_age               : 0.0</span>
<span class="go">patient_height            : 0.0</span>
<span class="go">patient_weight            : 0.0</span>
<span class="go">patient_birth_date        : 0</span>
<span class="go">physician_name            : b&#39;&#39;</span>
<span class="go">operator_name             : b&#39;&#39;</span>
<span class="go">study_description         : b&#39;C-11 Dynamic-1&#39;</span>
<span class="go">acquisition_type          : 4</span>
<span class="go">patient_orientation       : 3</span>
<span class="go">facility_name             : b&#39;ECAT&#39;</span>
<span class="go">num_planes                : 63</span>
<span class="go">num_frames                : 20</span>
<span class="go">num_gates                 : 1</span>
<span class="go">num_bed_pos               : 0</span>
<span class="go">init_bed_position         : 50.617</span>
<span class="go">bed_position              : [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]</span>
<span class="go">plane_separation          : 0.2425</span>
<span class="go">lwr_sctr_thres            : 0</span>
<span class="go">lwr_true_thres            : 350</span>
<span class="go">upr_true_thres            : 650</span>
<span class="go">user_process_code         : b&#39;&#39;</span>
<span class="go">acquisition_mode          : 0</span>
<span class="go">bin_size                  : 0.225</span>
<span class="go">branching_fraction        : 1.0</span>
<span class="go">dose_start_time           : 1111111111111</span>
<span class="go">dosage                    : 0.0</span>
<span class="go">well_counter_corr_factor  : 1.0</span>
<span class="go">data_units                : b&#39;&#39;</span>
<span class="go">septa_state               : 1</span>
<span class="go">fill                      : b&#39;&#39;</span>
</pre></div>
</div>
<p>Using your wits, the available tools, and data you should be able
to produce a sidecar file like the following for your nifti image.
Repeat this process for each image file/nifti you’re including
while reusing the filename for each image
and while substituting the extention to <code class="docutils literal notranslate"><span class="pre">.json</span></code> instead of <code class="docutils literal notranslate"><span class="pre">.nii</span></code>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Manufacturer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Siemens&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ManufacturersModelName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HR+&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bq/mL&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;BodyPart&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Brain&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;TracerName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DASB&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;TracerRadionuclide&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C11&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;TracerMolecularWeight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">282.39</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;TracerMolecularWeightUnits&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;g/mol&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;InjectedRadioactivity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">629.74</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;InjectedRadioactivityUnits&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MBq&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MolarActivity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">55.5</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MolarActivityUnits&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MBq/nmol&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;SpecificRadioactivity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">196.53670455752683</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;SpecificRadioactivityUnits&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MBq/ug&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Purity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">99</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ModeOfAdministration&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bolus&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;InjectedMass&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">3.2041852</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;InjectedMassUnits&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ug&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;AcquisitionMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;list mode&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ImageDecayCorrected&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ImageDecayCorrectionTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;TimeZero&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;17:28:40&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ScanStart&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;InjectionStart&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;FrameDuration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mf">300.066</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span>
<span class="w">        </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;FrameTimesStart&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">240</span><span class="p">,</span><span class="w"> </span><span class="mi">360</span><span class="p">,</span><span class="w"> </span><span class="mi">480</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span><span class="mi">900</span><span class="p">,</span><span class="w"> </span><span class="mf">1200.066</span><span class="p">,</span><span class="w"> </span><span class="mf">1800.066</span><span class="p">,</span>
<span class="w">        </span><span class="mf">2400.066</span><span class="p">,</span><span class="w"> </span><span class="mf">3000.066</span><span class="p">,</span><span class="w"> </span><span class="mf">3600.066</span><span class="p">,</span><span class="w"> </span><span class="mf">4200.066</span><span class="p">,</span><span class="w"> </span><span class="mf">4800.066</span><span class="p">,</span><span class="w"> </span><span class="mf">5400.066</span><span class="p">,</span><span class="w"> </span><span class="mf">6000.066</span><span class="p">,</span>
<span class="w">        </span><span class="mf">6600.066</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ReconMethodParameterLabels&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;lower_threshold&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;upper_threshold&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;recon_zoom&quot;</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ReconMethodParameterUnits&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;keV&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;keV&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ReconMethodParameterValues&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">350</span><span class="p">,</span><span class="w"> </span><span class="mi">650</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ScaleFactor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mf">8.548972374455843e-8</span><span class="p">,</span><span class="w"> </span><span class="mf">1.7544691388593492e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">1.3221580275057931e-7</span><span class="p">,</span>
<span class="w">        </span><span class="mf">1.2703590357432404e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1155360368775291e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">2.2050951997698576e-7</span><span class="p">,</span>
<span class="w">        </span><span class="mf">2.184752503353593e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">1.7056818535365892e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">1.6606901453997125e-7</span><span class="p">,</span>
<span class="w">        </span><span class="mf">1.5532630470715958e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">2.19175134930083e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0248222654117853e-7</span><span class="p">,</span>
<span class="w">        </span><span class="mf">2.277063231304055e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">2.425933018912474e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">2.3802238047210267e-7</span><span class="p">,</span>
<span class="w">        </span><span class="mf">2.514642005735368e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">2.802861729378492e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">2.797820570776821e-7</span><span class="p">,</span>
<span class="w">        </span><span class="mf">3.5299004252919985e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">4.6313422785715375e-7</span><span class="p">,</span><span class="w"> </span><span class="mf">4.904185857412813e-7</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ScatterFraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;DecayCorrectionFactor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mf">1.0056782960891724</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0171427726745605</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0287377834320068</span><span class="p">,</span>
<span class="w">        </span><span class="mf">1.0522810220718384</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0886797904968262</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1263376474380493</span><span class="p">,</span>
<span class="w">        </span><span class="mf">1.1851094961166382</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2685142755508423</span><span class="p">,</span><span class="w"> </span><span class="mf">1.3577889204025269</span><span class="p">,</span>
<span class="w">        </span><span class="mf">1.5278561115264893</span><span class="p">,</span><span class="w"> </span><span class="mf">1.811025857925415</span><span class="p">,</span><span class="w"> </span><span class="mf">2.328737735748291</span><span class="p">,</span>
<span class="w">        </span><span class="mf">3.271937131881714</span><span class="p">,</span><span class="w"> </span><span class="mf">4.597157001495361</span><span class="p">,</span><span class="w"> </span><span class="mf">6.459125518798828</span><span class="p">,</span>
<span class="w">        </span><span class="mf">9.075239181518555</span><span class="p">,</span><span class="w"> </span><span class="mf">12.750947952270508</span><span class="p">,</span><span class="w"> </span><span class="mf">17.915414810180664</span><span class="p">,</span>
<span class="w">        </span><span class="mf">25.1716251373291</span><span class="p">,</span><span class="w"> </span><span class="mf">35.36678695678711</span><span class="p">,</span><span class="w"> </span><span class="mf">49.69125747680664</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;PromptRate&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;RandomRate&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;SinglesRate&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ReconMethodName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Vendor&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ReconFilterType&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Shepp 0.5&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;All-pass 0.4&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ReconFilterSize&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;AttenuationCorrection&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;transmission scan&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Alright, now we’re getting somewhere, let’s rename these niftis
so that it’s easier to distinguish between them
and so that they’re both BIDS compliant.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># first lets divide the scans into their own sessions</span>
machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>mv<span class="w"> </span>sub-01/ses-01/<span class="w"> </span>sub-01/ses-testscan/

<span class="c1"># and make a second session folder for the rescan</span>
machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>sub-01/ses-testscan/<span class="w"> </span>sub-01/ses-retestscan/
machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>mv<span class="w"> </span>sub-01/sub01_7_anon.nii<span class="w"> </span>sub-01/ses-testscan/pet/sub-01_ses-testscan_pet.nii
machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>mv<span class="w"> </span>sub-01/sub01_8_anon.nii<span class="w"> </span>sub-01/ses-retestscan/pet/sub-01_ses-retestscan_pet.nii

<span class="c1"># some additional bash later and ......</span>
machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>tree
.
├──<span class="w"> </span>README
├──<span class="w"> </span>dataset_description.json
├──<span class="w"> </span>participants.json
├──<span class="w"> </span>participants.tsv
└──<span class="w"> </span>sub-01
<span class="w">    </span>├──<span class="w"> </span>ses-retestscan
<span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>pet
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_pet.json
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_recording-Autosampler_blood.json
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_recording-Autosampler_blood.tsv
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_recording-Manual_blood.json
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_recording-Manual_blood.tsv
<span class="w">    </span>│<span class="w">       </span>└──<span class="w"> </span>sub-01_ses-retestscan_pet.nii
<span class="w">    </span>└──<span class="w"> </span>ses-testscan
<span class="w">        </span>└──<span class="w"> </span>pet
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_pet.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_recording-Autosampler_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_recording-Autosampler_blood.tsv
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_recording-Manual_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_recording-Manual_blood.tsv
<span class="w">            </span>└──<span class="w"> </span>sub-01_ses-testscan_pet.nii

<span class="m">5</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">16</span><span class="w"> </span>files
</pre></div>
</div>
<p>That looks better, but we need to do something about our tabular/text data.
Since we’re only dealing with manual blood samples we can omit the autosampler
files from our data structure.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>sub-01/ses-retestscan/pet/*Auto*
machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>sub-01/ses-testscan/pet/*Auto*
machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>tree
.
├──<span class="w"> </span>README
├──<span class="w"> </span>dataset_description.json
├──<span class="w"> </span>participants.json
├──<span class="w"> </span>participants.tsv
└──<span class="w"> </span>sub-01
<span class="w">    </span>├──<span class="w"> </span>ses-retestscan
<span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>pet
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_pet.json
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_recording-Manual_blood.json
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_recording-Manual_blood.tsv
<span class="w">    </span>│<span class="w">       </span>└──<span class="w"> </span>sub-01_ses-retestscan_pet.nii
<span class="w">    </span>└──<span class="w"> </span>ses-testscan
<span class="w">        </span>└──<span class="w"> </span>pet
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_pet.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_recording-Manual_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_recording-Manual_blood.tsv
<span class="w">            </span>└──<span class="w"> </span>sub-01_ses-testscan_run-testscan_pet.nii
</pre></div>
</div>
<p>That looks better, now that we’ve got our nifti’s sorted
let’s do something about filling out our <code class="docutils literal notranslate"><span class="pre">*_blood.tsv</span></code> files and our <code class="docutils literal notranslate"><span class="pre">*_blood.json</span></code> files.</p>
<!-- TODO grab that image and add to the repo -->
<p>Here’s are the contents of <code class="docutils literal notranslate"><span class="pre">sub01_7_PLASMA.txt</span></code>:
<img alt="sub01_7_PLASMA.txt screenshot of excell" src="https://i.imgur.com/xBgDZcI.png" /></p>
<p>Since our plasma data is available we need to indicate as such
in our <code class="docutils literal notranslate"><span class="pre">*_blood.json</span></code> files so we do so now:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;PlasmaAvail&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MetaboliteAvail&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;WholeBloodAvail&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DispersionCorrected&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MetaboliteMethod&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HPLC&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MetaboliteRecoveryCorrectionApplied&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Time in relation to time zero defined by the _pet.json&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;s&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;plasma_radioactivity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Radioactivity in plasma samples&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bq/mL&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nt">&quot;metabolite_parent_fraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Parent fraction of the radiotracer.&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;unitless&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Additionally, we can open our <code class="docutils literal notranslate"><span class="pre">*_blood.tsv</span></code>
and add the plasma series of data to it from our base text file:</p>
<!-- TODO grab that image and add to the repo -->
<p><img alt="screenshot of unconverted sub-01_ses-testscan_recording-Manual_blood.tsv" src="https://i.imgur.com/VdFqh6H.png" /></p>
<p>Whoops, these numbers aren’t in SI units, so we quickly convert time
from minutes to seconds and Microcurie to Becquerel to conform to the spec.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you’re wondering what method was used to determine what units these unlabeled columns were in
we can only tell you that prior knowledge, access to the associated publishing,
or experience/domain knowledge coupled with a bit of guesswork
are required to make that determination.
One of the aims of adding PET to BIDS is to help to avoid confusion at this level of the process
and instead allow researchers to reserve that confusion
for use at some other point during the research process.</p>
</div>
<p>After a bit of conversion and the inclusion of the metabolite parent fraction
(which if present is
<a class="reference external" href="https://bids-specification.readthedocs.io/en/stable/04-modality-specific-files/09-positron-emission-tomography.html#blood-recording-data">recommended</a>
to be included):</p>
<!-- TODO grab that image and add to the repo -->
<p><img alt="screenshot of converted and minimally complete manual_blood.tsv" src="https://i.imgur.com/nWXcFsw.png" /></p>
<p>Now just repeat this process for each required field in the <code class="docutils literal notranslate"><span class="pre">*_blood.json</span></code> file
and/or for each recommended field
that you wish to include from your non-BIDS dataset into this bidsified one.
The final results of our efforts leads us to having this final <code class="docutils literal notranslate"><span class="pre">*blood_.json</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;PlasmaAvail&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;PlasmaFreeFraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">15.062331</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;PlasmaFreeFractionMethod&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Ultrafiltration&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;WholeBloodAvail&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DispersionCorrected&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MetaboliteAvail&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MetaboliteMethod&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HPLC&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MetaboliteRecoveryCorrectionApplied&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;time&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Time in relation to time zero defined by the _pet.json&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;s&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;plasma_radioactivity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Radioactivity in plasma samples&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bq/mL&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;metabolite_parent_fraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Parent fraction of the radiotracer&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arbitrary&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="last-pass">
<h4>Last Pass<a class="headerlink" href="#last-pass" title="Permalink to this headline">¶</a></h4>
<p>If you’re thinking that we failed to document or include our T1 image
from the start you would be correct.</p>
<p>There are many resources documenting that process
<a class="reference external" href="https://bids-standard.github.io/bids-starter-kit/tutorials/mri.html">here</a>.</p>
<p>Once you’ve handled converting your MR images into BIDS
your directory should look like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>machine:NewBidsDataSet<span class="w"> </span>user$<span class="w"> </span>tree
.
├──<span class="w"> </span>README
├──<span class="w"> </span>dataset_description.json
├──<span class="w"> </span>participants.json
├──<span class="w"> </span>participants.tsv
└──<span class="w"> </span>sub-01
<span class="w">    </span>├──<span class="w"> </span>ses-retestscan
<span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>pet
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_pet.json
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_recording-Manual_blood.json
<span class="w">    </span>│<span class="w">       </span>├──<span class="w"> </span>sub-01_ses-retestscan_recording-Manual_blood.tsv
<span class="w">    </span>│<span class="w">       </span>└──<span class="w"> </span>sub-01_ses-retestscan_pet.nii
<span class="w">    </span>└──<span class="w"> </span>ses-testscan
<span class="w">        </span>├──<span class="w"> </span>anat
<span class="w">        </span>│<span class="w">   </span>├──<span class="w"> </span>sub-01_ses-testscan_T1w.json
<span class="w">        </span>│<span class="w">   </span>└──<span class="w"> </span>sub-01_ses-testscan_T1w.nii
<span class="w">        </span>└──<span class="w"> </span>pet
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_pet.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_recording-Manual_blood.json
<span class="w">            </span>├──<span class="w"> </span>sub-01_ses-testscan_recording-Manual_blood.tsv
<span class="w">            </span>└──<span class="w"> </span>sub-01_ses-testscan_pet.nii
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="validating-your-converted-pet-bids-data-set">
<h2>Validating your converted PET BIDS data set<a class="headerlink" href="#validating-your-converted-pet-bids-data-set" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installing-the-validator">
<h3>Installing the validator<a class="headerlink" href="#installing-the-validator" title="Permalink to this headline">¶</a></h3>
<p>The above structure is a valid BIDS dataset,
however the bids-validator is a much more accurate and trustworthy method
for making that determination.
Follow the instructions <a class="reference external" href="https://github.com/bids-standard/bids-validator">here</a>
to collect and install the validator.</p>
</div>
<div class="section" id="validating-your-new-dataset">
<h3>Validating your new dataset<a class="headerlink" href="#validating-your-new-dataset" title="Permalink to this headline">¶</a></h3>
<p>Using the validator installed above in the previous step point it at your data
and check to see if your conversion was successful:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>machine:Projects<span class="w"> </span>user$<span class="w"> </span>bids-validator<span class="w"> </span>NewBidsDataSet/
bids-validator@1.7.2

<span class="w"> </span><span class="m">1</span>:<span class="w"> </span><span class="o">[</span>ERR<span class="o">]</span><span class="w"> </span>Invalid<span class="w"> </span>JSON<span class="w"> </span>file.<span class="w"> </span>The<span class="w"> </span>file<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>formatted<span class="w"> </span>according<span class="w"> </span>the<span class="w"> </span>schema.<span class="w"> </span><span class="o">(</span>code:<span class="w"> </span><span class="m">55</span><span class="w"> </span>-<span class="w"> </span>JSON_SCHEMA_VALIDATION_ERROR<span class="o">)</span>
<span class="w">  </span>./dataset_description.json
<span class="w">   </span>Evidence:<span class="w"> </span>.DatasetType<span class="w"> </span>should<span class="w"> </span>be<span class="w"> </span>equal<span class="w"> </span>to<span class="w"> </span>one<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>allowed<span class="w"> </span>values
<span class="w">  </span>./dataset_description.json
<span class="w">   </span>Evidence:<span class="w"> </span>.EthicsApprovals<span class="w"> </span>should<span class="w"> </span>be<span class="w"> </span>array

<span class="w"> </span>Please<span class="w"> </span>visit<span class="w"> </span>https://neurostars.org/search?q<span class="o">=</span>DATASET_DESCRIPTION_JSON_MISSING<span class="w"> </span><span class="k">for</span><span class="w"> </span>existing<span class="w"> </span>conversations<span class="w"> </span>about<span class="w"> </span>this<span class="w"> </span>issue.


<span class="w">        </span>Summary:<span class="w">               </span>Available<span class="w"> </span>Tasks:<span class="w">        </span>Available<span class="w"> </span>Modalities:
<span class="w">        </span><span class="m">13</span><span class="w"> </span>Files,<span class="w"> </span><span class="m">4</span>.55GB<span class="w">                               </span>pet
<span class="w">        </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Subject<span class="w">                                    </span>blood
<span class="w">        </span><span class="m">2</span><span class="w"> </span>-<span class="w"> </span>Sessions<span class="w">                                   </span>anat


<span class="w"> </span>If<span class="w"> </span>you<span class="w"> </span>have<span class="w"> </span>any<span class="w"> </span>questions,<span class="w"> </span>please<span class="w"> </span>post<span class="w"> </span>on<span class="w"> </span>https://neurostars.org/tags/bids.
</pre></div>
</div>
<p>Good enough! But, in all seriousness the error messages and output
from the bids-validator are <strong>invaluable</strong> during the conversion process.
The error messages will guide you to the correct format; do not fear them.
Running the validator during the conversion process will help to increase your familiarity
with the specification and ensure that your data is properly formatted.</p>
</div>
</div>
<div class="section" id="tools-and-resources-for-pet-conversion">
<h2>Tools and resources for PET conversion<a class="headerlink" href="#tools-and-resources-for-pet-conversion" title="Permalink to this headline">¶</a></h2>
<p>Some useful tools and resources that have been used in this document are as
follows:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bids-standard/bids-validator">BIDS Validator</a>, which
fully supports PET</p></li>
<li><p><a class="reference external" href="https://github.com/openneuropet/PET2BIDS">PET2BIDS</a> is a MATLAB and Python utility
for converting your data to PET BIDS format</p></li>
<li><p><a class="reference external" href="https://gitlab.utu.fi/vesoik/tpcclib">TPCCLIIB</a> is a command line library
containing (among many others) PET tools such as <code class="docutils literal notranslate"><span class="pre">ecat2nii</span></code>
that will be used below to convert the imaging data from a PET dataset into nifti format.
The Turku PET Centre site can be found <a class="reference external" href="https://turkupetcentre.fi/">here</a>
for additional information on anything PET.</p></li>
<li><p>a <a class="reference external" href="https://github.com/bids-standard/bids-starter-kit/tree/main/templates">BIDS PET Template</a>
from this starter kit to initially populate
and translate text/tabulature/csv blood data
into BIDS PET compliant <code class="docutils literal notranslate"><span class="pre">.tsv</span></code> and <code class="docutils literal notranslate"><span class="pre">.json</span></code> files.</p></li>
<li><p><a class="reference external" href="https://github.com/rordenlab/dcm2niix">dcm2niix</a> can be used
if your raw pet data happens to be in a DICOM format.
Additionally this opens up the use of tools
such as <a class="reference external" href="https://support.dcmtk.org/docs/dcmdump.html">dcmdump</a>
from the <a class="reference external" href="https://support.dcmtk.org/docs/">dcmtk</a> to help in your conversion.</p></li>
</ul>
</div>
<div class="section" id="final-thoughts">
<h2>Final thoughts<a class="headerlink" href="#final-thoughts" title="Permalink to this headline">¶</a></h2>
<p>As of now, PET is still quite new to the BIDS standard,
but at this very moment there are people working on stream-lining data collection
and conversion to help move PET into this standard.</p>
<p>If you’re reading this you’ve just become one of those people.
Feel free to reach out to the <a class="reference external" href="https://openneuropet.github.io/">OpenNeuroPET project</a></p>
<!-- links -->
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="asl.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">ASL data conversion</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="mri.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MRI data conversion</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The BIDS community<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>